!function(t,n){module&&module.exports?module.exports=n():define&&define.amd?define(n):t.Class=n()}(this,function(){"use strict";function t(){}function n(t){return i(this,t)}function r(n,r){var o=arguments;switch(o.length){case 0:throw new Error("Illegal arguments");case 1:r=h(o[0])?{}:n;break;default:d(r)&&(r.name=n)}if(r){var i=r.name;if(!/^[a-z\$_][\w\$]*$/i.test(i))throw new Error("Invalid class name: "+i)}return e(t,r)}function e(r,o){function h(){}1===arguments.length&&(g(r)?o={}:(o=r,r=t));var d=o.init,O=o.statics,$=!1!==o.pythonic,j=o.name||"Class$"+b.toString(16);"function"!=typeof d&&(d=w),$&&(d=p(d));var x=Object.getOwnPropertyNames(o);x=l(x=l(x=l(x=l(x,"init"),"statics"),"pythonic"),"name"),h.prototype=r.prototype;var A=function(t,n){m[t]||(m[t]=new Function("init","return function "+t+"(){return init.apply(this, arguments);}"));return m[t](n)}(j,d);return A.prototype=new h,c(A.prototype,"constructor",A),c(A.prototype,"clazz",A),c(A.prototype,"uber",r.prototype),c(A.prototype,"$callSuper",function(t){var n=r.prototype[t];if(!(n instanceof Function))throw new Error;var e=arguments[1];return v(e)||(e=y(arguments,1)),n.apply(this,e)}),c(A,"superclass",r),c(A,"isAssignableFrom",n),c(A,"$classdef",function(t,n){return Object.assign({},n.$classdef,t)}(o,r)),c(A,"extend",function(t){return e.call(A,A,t)}),A.prototype.$super=function(t){var n=arguments;if(v(t)&&(n=$?y(t,1):t),i(A,Array))this.push.apply(this,n);else{var e=r.prototype;if(e&&e.$super){var o=e.$super;this.$super=function(){return o.apply(this,arguments)},e.clazz.apply(this,n),this.$super=o}}},function(t,n,r){n||(n={});u(n,r),u(t,n)}(A,O,r),$?a(o,x,function(t,n){var r=t[n];g(r)?A.prototype[n]=p(r):s(t,A.prototype,n)}):f(o,A.prototype,x,function(t,n,r){return g(t[r])}),b++,A}function o(t){function n(t){return t===Object.prototype?[]:Object.keys(t).concat(n(Object.getPrototypeOf(t)))}var r={};return n(t).filter(function(t){return!r[t]&&(r[t]=!0,!0)}).filter(function(t){return"$super"!==t})}function i(t,n){return!(!n||!t)&&(t===n||t.superclass===n||Object.create(t.prototype)instanceof n)}function u(t,n){return Object.setPrototypeOf?Object.setPrototypeOf(t,n):{__proto__:[]}instanceof Array?t.__proto__=n:f(n,t,Object.getOwnPropertyNames(n)),t}function c(t,n,r){Object.defineProperty(t,n,{value:r,enumerable:!1,configurable:!1,writable:!1})}function a(t,n,r){g(r)||(r=w),h(n)&&r(t,n);for(var e=0;e<n.length;e++)r(t,n[e])}function f(t,n,r,e){g(e)||(e=function(){return!0}),a(t,r,function(t,r){e(t,n,r)&&s(t,n,r)})}function s(t,n,r){var e=Object.getOwnPropertyDescriptor(t,r);d(e)&&Object.defineProperty(n,r,e)}function p(t){var n=function(){var n=this,r=[n].concat(function(t){return y(t,0)}(arguments));return t.apply(n,r)};return n.toString=function(){return t.toString()},n.valueOf=function(){return t},n}function l(t,n){if(t){if(t instanceof Array){var r=t.indexOf(n);return r>-1&&t.splice(r,1),t}return v(t)?l(Array.prototype.slice.call(t,0),n):t}return t}function y(t,n){return Array.prototype.slice.call(t,n)}function h(t){return"string"==typeof t}function g(t){return"function"==typeof t}function d(t){return void 0!==t&&null!==t}function v(t){return t&&"[object Arguments]"===t.toString()}function w(){}t.create=r,t.extend=e,t.mix=function(n){return new function(n){this.with=function(){return Array.prototype.reduce.call(arguments,function(n,r){return function(n,r){var e=function(n,r){var e=!1!==n.$classdef.pythonic;return t.extend(n,{name:r,pythonic:e,init:e?function(){n.apply(this,y(arguments,1))}:function(){n.apply(this,arguments)}})}(r,r.name+"$"+n.name);return t.extend(n,e.$classdef)}(n,r)},n)}}(n)},t.singleton=function(t,n){var o;switch(arguments.length){case 0:throw new Error("Illegal arguments");case 1:o=r(t);break;default:if(h(t))o=r(t,n);else{if(!g(t))throw new Error("Illegal arguments");o=e(t,n)}}return new o},t.isAssignableFrom=n,t.proxy=function(t,n){if(!t)throw new Error("cannot proxy null or undefined object");if(!(n instanceof Function))throw new Error("handler is not function");var r=Object.create(t);return o(t).reduce(function(r,e){var o=t[e];return o instanceof Function&&(r[e]=function(r){function e(){return n.call(t,r,arguments)}return e.toString=function(){return r.toString()},e}(o)),r},r)},t.members=o;var m={},b=0;return t});